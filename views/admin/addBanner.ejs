<%- include("../../views/partials/admin/header") %>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<style>
  body {
    background-color: #f9f9f9;
    font-family: 'Poppins', sans-serif;
  }

  .card {
    border: none;
    border-radius: 12px;
    background: #ffffff;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
  }

  .form-label {
    font-weight: 500;
    margin-bottom: 0.5rem;
  }

  .form-control {
    border-radius: 6px;
    padding: 10px;
    font-size: 14px;
  }

  .form-control:focus {
    box-shadow: none;
    border-color: #0071ff;
  }

  .btn-primary {
    background-color: #0071ff;
    border: none;
    padding: 10px 20px;
    border-radius: 6px;
    font-weight: 500;
  }

  .btn-primary:hover {
    background-color: #005dd1;
  }

  .btn-secondary {
    background-color: #6c757d;
    border: none;
    padding: 10px 20px;
    border-radius: 6px;
    font-weight: 500;
  }

  .btn-secondary:hover {
    background-color: #5a6268;
  }

  .text-danger {
    font-size: 13px;
    margin-top: 4px;
  }

  #preview {
    max-width: 100%;
    height: auto;
    border-radius: 10px;
    margin-top: 10px;
    border: 1px solid #ddd;
  }
</style>


<div class="container mt-5">
  <div class="card shadow p-4">
    <h3 class="mb-4">Add New Banner</h3>
    <form action="/admin/addBanner" method="POST" enctype="multipart/form-data" onsubmit="return validateBannerForm()">
      
      <div class="mb-3">
        <label for="title" class="form-label">Banner Title</label>
        <input type="text" class="form-control" id="title" name="title" placeholder="Enter banner title">
        <div id="error-title" class="text-danger small"></div>
      </div>

      <div class="mb-3">
        <label for="description" class="form-label">Description</label>
        <textarea class="form-control" id="description" name="description" rows="3" placeholder="Enter description"></textarea>
        <div id="error-description" class="text-danger small"></div>
      </div>

      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="startDate" class="form-label">Start Date</label>
          <input type="datetime-local" class="form-control" id="startDate" name="startDate">
          <div id="error-startDate" class="text-danger small"></div>
        </div>
        <div class="col-md-6 mb-3">
          <label for="endDate" class="form-label">End Date</label>
          <input type="datetime-local" class="form-control" id="endDate" name="endDate">
          <div id="error-endDate" class="text-danger small"></div>
        </div>
      </div>

      <div class="mb-3">
        <label for="link" class="form-label">Redirect Link (optional)</label>
        <input type="text" class="form-control" id="link" name="link" placeholder="https://yourstore.com/category/">
        <div id="error-link" class="text-danger small"></div>
      </div>

      <div class="mb-4">
        <label for="image" class="form-label">Upload Banner Image</label>
        <input type="file" class="form-control" id="image" name="image" accept="image/*" onchange="previewBannerImage(event)">
        <div id="error-image" class="text-danger small"></div>
        <img id="preview" class="mt-3 rounded shadow-sm" style="display: none; height: 180px;">
      </div>

      <button type="submit" class="btn btn-primary">Publish Banner</button>
      <a href="/admin/banner" class="btn btn-secondary ms-2">Cancel</a>

    </form>
  </div>
</div>

<script>
  function previewBannerImage(event) {
    const preview = document.getElementById('preview');
    preview.src = URL.createObjectURL(event.target.files[0]);
    preview.style.display = 'block';
  }

  function validateBannerForm() {
    let isValid = true;

    const fields = [
      { id: 'title', name: 'Title' },
      { id: 'description', name: 'Description' },
      { id: 'startDate', name: 'Start Date' },
      { id: 'endDate', name: 'End Date' }
    ];

    fields.forEach(field => {
      const input = document.getElementById(field.id);
      const error = document.getElementById('error-' + field.id);
      if (!input.value.trim()) {
        error.textContent = `${field.name} is required`;
        isValid = false;
      } else {
        error.textContent = '';
      }
    });

    const start = new Date(document.getElementById('startDate').value);
    const end = new Date(document.getElementById('endDate').value);
    if (start && end && start > end) {
      document.getElementById('error-endDate').textContent = 'End Date must be after Start Date';
      isValid = false;
    }

    const image = document.getElementById('image');
    if (!image.files[0]) {
      document.getElementById('error-image').textContent = 'Banner image is required';
      isValid = false;
    }

    return isValid;
  }
</script>

<%- include("../../views/partials/admin/footer") %>
